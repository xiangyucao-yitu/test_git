i made some changes.
this is in testing branch.
